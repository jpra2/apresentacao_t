% \documentclass{article}
\documentclass[professionalfont]{beamer}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% packages
\usepackage[utf8]{inputenc}
\usepackage[brazilian]{babel}
\usepackage{amssymb} %Mathematics
\usepackage{amsfonts}%Mathematics
\usepackage{amsmath,amscd}%Mathematics
\usepackage{amsthm}%Mathematics
\usepackage{mathrsfs}%Mathematics font
\usepackage{newtxtext,newtxmath}
\usepackage{xfrac}
\usepackage{cite}
\usepackage{ragged2e}
\usepackage{geometry}
\usepackage{calc}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{array}
\usepackage{tikz-3dplot}
\usepackage{tikz-dimline}
\usepackage[absolute,overlay]{textpos} % para usar textblock
\usepackage{tcolorbox}
\usepackage[absolute,overlay]{textpos}
% \usepackage[font=small,compatibility=false]{caption}
\usepackage[font=footnotesize]{subcaption}
% \usepackage{subfig}
\usepackage{nicefrac}
% % tabelas
% \usepackage{tabularx,ltxtable} % also load longtable
% \usepackage{array,xparse}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% tabelas
\usepackage{tabularx,ltxtable} % also load longtable
\usepackage{array,xparse}
% \usepackage{longtable}
\usepackage{makecell}
% \usepackage{hhline}
\usepackage{cellspace}
\usepackage{colortbl}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% definitions
\everymath{\displaystyle}
\usetheme{Warsaw}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%
\setbeamertemplate{caption}[numbered]
%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%
% -- citacoes --
% \usepackage[brazilian,hyperpageref]{backref}	 % Paginas com as citações na bibl
\usepackage[alf,abnt-repeated-title-omit=yes,abnt-emphasize=bf,abnt-etal-list=0]{abntex2cite}
% \usepackage[alf,abnt-repeated-title-omit=yes,abnt-etal-list=0]{abntex2cite}
\citebrackets()
% -- citacoes --
%%%%%%%%%%%%%%%%%%%%%%

\input{definitions.tex}


\title[NU-ADM]{Aplicação do método Multinível Algébrico Dinâmico Não Uniforme (NU-ADM) no escoamento composicional em reservatórios de petróleo}
\author[João Paulo Rodrigues de Andrade]{João Paulo Rodrigues de Andrade}
\institute[UFPE]{Universidade Federal de Pernambuco}
% \titlegraphic{\includegraphics[scale=0.2]{./imgs/ufpe.png} \hspace{0.5cm} \includegraphics[scale=0.2]{./imgs/ufpe.png}}

\date{}

\newcommand\Wider[2][3em]{%
\makebox[\linewidth][c]{%
  \begin{minipage}{\dimexpr\textwidth+#1\relax}
  \raggedright#2
  \end{minipage}%
  }%
}

%%%%%%%%%%%%%%%%%%%
%% tikz
\usetikzlibrary{matrix}
\usetikzlibrary{calc,3d}
\usetikzlibrary{arrows,positioning}
\usetikzlibrary{shapes.callouts}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{decorations.text}
\usetikzlibrary{math}
%%%%%%%%%%%%%%%%%%%


\setbeamersize{text margin left=0.5cm,text margin right=0.5cm}
\newlength\MyColSep
\setlength\MyColSep{1cm}
\newlength\MyColWd
\setlength\MyColWd{.5\textwidth}


\setbeamertemplate{sidebar right}{}
\setbeamertemplate{footline}{%
\hfill\usebeamertemplate***{navigation symbols}
\hspace{1cm}\insertframenumber{}/\inserttotalframenumber}


\begin{document}

% {
% \setbeamertemplate{background}{%
%   \raisebox{-1cm}{%
%     \parbox[c]{3cm}{\centering%
%       \includegraphics[width=2cm]{./imgs/ufpe.png}%
%     }%
%     \parbox[c]{\dimexpr\paperwidth-3cm\relax}{\centering%
%       {\Large The Name of the University}%
%     }%
%   }%
% }

\begin{frame}
    % \titlepage
    \begin{minipage}{\textwidth}
    
    \begin{textblock*}{5cm}(0.5cm,2.3cm) % {block width} (coords)
        \includegraphics[scale=0.2]{./imgs/ufpe.png}
    \end{textblock*}
    
    \begin{textblock*}{8cm}(2.3cm,3.5cm) % {block width} (coords)
        \Large \instituicao
    \end{textblock*}
    
    \begin{textblock*}{5cm}(10.5cm,2.4cm) % {block width} (coords)
        \includegraphics[scale=0.25]{./imgs/padmec.jpeg}
    \end{textblock*}
    \end{minipage}
    
    \vspace{1.8cm}
    
    \begin{minipage}{\textwidth}
        \begin{tcolorbox}[halign=center,
    valign=center,colupper=black,boxsep=1pt,width=\textwidth,colback={white},colbacktitle=yellow]    
            \Large \titulo
        \end{tcolorbox}
    \end{minipage}
    
    \vspace{0.3cm}
    
    \begin{minipage}{\textwidth}
        \autor
        
        Orientador: \orientador
    \end{minipage}
    
    \vfill
        
    Recife, \dia
    
    % João Paulo Rodrigues de Andrade
    
    % Orientador: Darlan Karlo Elisiário de Carvalho
    
    % Recife, \today
    
\end{frame}

\begin{frame}{Sumário}
\begin{columns}[t]
        \begin{column}{.4\textwidth}
            \tableofcontents[sections={1-3}]
        \end{column}
        \begin{column}{.4\textwidth}
            \tableofcontents[sections={4-6}]
        \end{column}
    \end{columns}
\end{frame}

\section{Introdução}



\begin{frame}
\frametitle{Introdução}
\index{Introdução}
\begin{itemize}
    \item Importância da simulação computacional
    \item Importância da utilização de modelos composicionais
    \item Problema do tempo de simulação
    \item Métodos de Transferência de escala: \textit{Upscaling}, Multiescala, ADM (\textit{Algebraic Dynamic Multilevel Method})
    \item Método NU-ADM (\textit{Non Uniform Algebraic Dynamic Multilevel Method})
\end{itemize}
\end{frame}

\section{Objetivos}

\subsection{Geral}
\begin{frame}{Objetivos}

    \begin{block}{Geral}
        \begin{itemize}
            \item Desenvolver uma bliblioteca na libguagem Python que realize a transferência de escala, aplicando o método ADM não uniforme (NU-ADM) em modelos que lidam com escoamento composicional.
        \end{itemize}
    \end{block}
    
\end{frame}

\subsection{Específicos}
\begin{frame}{Objetivos}
    
    \begin{block}{Específicos}
        \begin{itemize}
            \item Desenvolver um interpretador os dados do reservatório
            \item Aplicar o método NU-ADM no modelo composicional IMPEC
            \item Comparar a solução da malha fina com a obtida por meio do método NU-ADM
        \end{itemize}
    \end{block}
    
\end{frame}

\section{Fundamentação Teórica}

\subsection{Lei de Darcy}
\begin{frame}{Lei de Darcy}

\begin{textblock*}{.5\paperwidth}(0.2cm,2.7cm)
    \centering
    \includegraphics[scale=0.4]{./imgs/im1.png}
    \footnotesize Retirado de \cite{Rosa2006}.
\end{textblock*}

\begin{textblock*}{.48\paperwidth}(6.4cm,3cm)
    Darcy estabeleceu que, para qualquer vazão, a velocidade do fluxo é diretamente proporcional à diferença nas alturas manométricas \cite{044441830X}.
    \begin{equation}
        v = \perm \dfrac{h_{1} - h_{2}}{L}
    \end{equation}
    
    
\end{textblock*}

\end{frame}

\begin{frame}{Lei de Darcy}
    Generalizando:
    \begin{equation}
        \velocity = -\permTensor \dfrac{1}{\mu} (\grad{p} - \grad{D})
    \end{equation}
    
    \vspace{0.3cm}
    
    \begin{description}[]
        \item $\permTensor$ : tensor permeabilidade da rocha;
        \item $\velocity$: velocidade do fluido;
        \item $p$: pressão do fluido;
        \item $\mu$: viscosidade do fluido;
        \item $D$: altura do fluido
    \end{description}
    
    \begin{textblock*}{.5\paperwidth}(6cm,5cm)
        \begin{align*}
            \permTensor = 
            \begin{bmatrix}
            	K_{xx} & K_{xy} & K_{xz} \\
            	K_{yx} & K_{yy} & K_{yz} \\
            	K_{zx} & K_{zy} & K_{zz}
	        \end{bmatrix}
        \end{align*}
    \end{textblock*}
    
\end{frame}

\subsection{Método dos volumes finitos}
\begin{frame}{Método dos volumes finitos}
\begin{figure}[!ht]
\centering
    \caption{Exemplos de malhas computacionais}
    \begin{subfigure}[t]{.45\textwidth}
        \centering
        \includegraphics[scale=0.25]{./imgs/im3.png}
        \caption{3D estruturada}
        \label{fig:volumes_finitos1.a}
    \end{subfigure}
    \begin{subfigure}[t]{.45\textwidth}
        \centering
        \includegraphics[scale=0.25]{./imgs/im4.png}
        \caption{2D estruturada}
        \label{fig:volumes_finitos1.b}
    \end{subfigure}
    \\
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[scale=0.27]{./imgs/im6.png}
        \caption{3D não estruturada}
        \label{fig:volumes_finitos1.c}
    \end{subfigure}
    \begin{subfigure}{.45\textwidth}
        \centering
        \includegraphics[scale=0.27]{./imgs/im5.png}
        \caption{2D não estruturada}
        \label{fig:volumes_finitos1.d}
    \end{subfigure}

    {\footnotesize Retirado de \cite{Knut2019}}
\end{figure}

\end{frame}

\begin{frame}{Método dos volumes finitos}

\begin{columns}
\begin{column}{0.6\textwidth}
Equação do balanço de massa na forma integral:
  \begin{equation}
	\label{eq:volumes_finitos.1}
	\int_{V} \pd{\rho}{t} dV = \int_{V} - \div{(\rho \velocity)} dV + \int_{V} Q dV
\end{equation}

Aplicando o teorema da divergência de Gauss na segunda integral de \eqref{eq:volumes_finitos.1} \cite{Souza2015}:

 \begin{equation}
	 \label{eq:volumes_finitos.2}
	 \int_{V} - \div{(\rho \velocity)} dV = \int_{\volumeSurface} - \rho \velocity \cdot \normalVec \text{ } d \volumeSurface
 \end{equation}

\end{column}
\begin{column}{0.4\textwidth}  %%<--- here
    \begin{equation}
        \fineTransmissibility \vectorPressure = \vectorfineSource
    \end{equation}

    \begin{description}[]
        \small
        \item $\volumeSurface$: contorno do volume $V$;
        \item $\rho$: densidade do fluido;
        \item $Q$: termo fonte ou sumidouro;
        \item $t$: tempo;
        \item $\fineTransmissibility$: matriz transmissibilidade;
        \item $\vectorPressure$: vetor de pressão;
        \item $\vectorfineSource$: vetor do termo fonte;
        \item $^{f}$: Malha fina
    \end{description}
    
\end{column}
\end{columns}

\end{frame}



\subsection{Modelo Composicional}

\begin{frame}{Simplificações}
    \begin{itemize}
        \item Escoamento isotérmico;
        \item Equilíbrio termodinâmico local entre as fases;
        \item Ausência do termo de pressão capilar;
        \item Ausência do termo de gravidade;
        \item A velocidade é dada pela Lei de Darcy;
        \item O componente água é imiscível;
        \item O meio está totalmente saturado;
        \item Rocha pouco compressível;
        \item Não há reacão química entre os fluidos;
        \item Não há interação entre rocha e fluido;
        \item Não há o fenômeno de dispersão;
        \item A viscosidade da fase água é constante;
        \item São consideradas 3 fases: água, óleo e gás.
    \end{itemize}
    
\end{frame}

\begin{frame}{Equações de estado}

% \begin{columns}
%     \begin{column}{0.6\textwidth}


%     \end{column}
%     \begin{column}{0.4\textwidth}  %%<--- here
%     \end{column}
% \end{columns}
    
    Nesse trabalho foi utilizada a equação de Peng-Robinson dada por \cite{Chen2007}:
    \begin{equation}
        \label{eq:eos.1}
        \pressure_{\phase} = \dfrac{\rConstant \temperature}{\molarphaseVolume - \bPhase} - \dfrac{\aPhase}{\molarphaseVolume(\molarphaseVolume + \bPhase) + \bPhase(\molarphaseVolume - \bPhase)}
    \end{equation}
    \begin{columns}
        \begin{column}{0.6\textwidth}
            \begin{description}[]
                \item $R$ constante dos gases ideais;
                \item $T$: temperatura;
                \item $\molarphaseVolume$: volume molar;
                \item $\aPhase, \bPhase$: variáveis empíricas da equação
                \item $_{j}$: fase
            \end{description}
        \end{column}
    \end{columns}
    
\end{frame}

\begin{frame}{Equações de estado}

    Sabendo que $\ZfactorPhase = \dfrac{\pressure_{\phase} \molarphaseVolume}{\rConstant \temperature}$, substituindo em \eqref{eq:eos.1} e fazendo as devidas manipulações, chega-se a equação cúbica para $\ZfactorPhase$:

    \begin{equation}
        \label{eq:eos.8}
        \ZfactorPhase^{3} - (1 - \BPhase) \ZfactorPhase^{2} + (\APhase - 2 \BPhase - 3 \BPhase^{2}) \ZfactorPhase - (\APhase \BPhase - \BPhase^{2} - \BPhase^{3}) = 0,
    \end{equation}

    sendo:

    \begin{equation}
        \label{eq:eos.9}
        \APhase = \dfrac{\aPhase \pressure_{\phase}}{\rConstant^{2} \temperature^{2}}, \hspace{1cm} \BPhase = \dfrac{\bPhase \pressure_{\phase}}{\rConstant \temperature}, 
    \end{equation}

    e $\ZfactorPhase$ o fator de compressibilidade do fluido. O método de solução das raízes de \eqref{eq:eos.9} pode ser encontrado em \cite{Chen2007,Chen2006,Soprano_2013}.

\end{frame}

\begin{frame}{Equações de estado}
    Fugacidade: é uma medida da quantidade que um fluido desvia-se do comportamento do gás ideal, dada por:

    \begin{equation}
        \label{eq:eos.11}
        \fugacity = \pressure_{\phase} \molarPartialFrac_{\component \phase} \coefFugacity_{\component \phase}, \hspace{0.7cm} \component=1,...,\numberOfComponents, \hspace{0.7cm} j = o,g ,
    \end{equation}

    \begin{description}[]
        \item $\molarPartialFrac_{\component \phase}$: fração molar do componente ($\component$) na fase ($\phase$);
        \item  $\coefFugacity_{\component \phase}$: coeficiente de fugacidade do componente $\component$ na fase $\phase$;
        \item $\fugacity$: fugacidade do componente $\component$ na fase $\phase$;
        \item $\numberOfComponents$: número de componentes
    \end{description}
    
\end{frame}

\begin{frame}{Equações de Estado}
    Onde $\coefFugacity_{\component \phase}$ pode ser encontrado por

    \begin{equation}
        \small
        \label{eq:eos.10}
        \begin{aligned}
            &\ln (\coefFugacity_{\componentt \phase}) = \dfrac{b_{\componentt}}{\bPhase} (\ZfactorPhase - 1) - \ln (\ZfactorPhase - \BPhase)\\
            &- \dfrac{\APhase}{2\sqrt{2} \BPhase} \left(\dfrac{2}{\aPhase} \sum_{\componenttt}^{\numberOfComponents} \molarPartialFrac_{\componenttt \phase}(1 - \binaryInter_{\componentt \componenttt})\sqrt{a_{\componentt} a_{\componenttt}} - \dfrac{b_{\componentt}}{\bPhase} \right) \ln \left(\dfrac{\ZfactorPhase + \left[1 + \sqrt{2} \right] \BPhase}{\ZfactorPhase - \left[1 - \sqrt{2} \right] \BPhase} \right),
        \end{aligned}
    \end{equation}

    Sendo $\binaryInter_{\componentt \componenttt}$ o coeficiente de interação binária entre os componentes $\componentt$ e $\componenttt$.

\end{frame}

\begin{frame}{Cálculo de Estabilidade e Flash}

    \begin{itemize}
        \item O objetivo do cálculo de estabilidade é verificar se, dada as propriedades do fluido, ele vai se dividir em duas fases (óleo e gás) ou vai permancer numa fase apenas;
        \item Caso o fluido se divida em duas fases, no cálculo de flash são encontrados os valores de frações molares dos componentes em cada fase e os respectivos valores de frações molares das fases óleo é gás, utilizando o procedimento de \citeonline{Rachford_1952}.
    \end{itemize} 
    
\end{frame}

\begin{frame}{Equação da pressão}
    Equação do balanço molar \cite{Fernandes_2014}:

    \begin{equation}
        \label{eq:modelo_mat.1}
        \dfrac{1}{\bulkVolume} \pd{\molNumber_{\component}}{t} = \sum_{\phase}^{\numberOfPhases} \div{\left(\molarPartialFrac_{\component \phase} \molarDensityPhase \velocity_{\phase} \right)} + \dfrac{\mSourceTerm_{\component}}{\bulkVolume} ,
    \end{equation}

    \begin{description}[]
        \item $\molNumber_{\component}$ = número de mols do componente $\component$;
        \item $\molarDensityPhase \left[ \dfrac{mol}{\m3} \right]$ = densidade molar da fase $\phase$;
        \item $\mSourceTerm_{\component} \left[ \dfrac{mol}{s} \right]$ = termo fonte do componente $\component$;
        \item $\numberOfPhases$ = número de fases;
        \item $\bulkVolume$ = Volume total
    \end{description}
\end{frame}

\begin{frame}{Equação da pressão}
    A equação da pressão é obtida igualando o volume poroso ao volume do fluido
    \cite{Acs_1985}:

    \begin{equation}
        \label{eq:modelo_mat.2}
        \poroVolume (\pressure) = \totalFluidVolume (\pressure, \molNumber_{1}, \molNumber_{2}, ..., \molNumber_{\numberOfComponents + 1}),
    \end{equation}

    \begin{description}[]
        \item $\poroVolume$ = volume poroso = $\porosidade \bulkVolume$;
        \item $\porosidade$ = porosidade = $\porosidadeIni \left[1 + \rockCompress (\pressure - \pressureIni) \right]$;
        \item $\totalFluidVolume$ = volume total do fluido 
        \item $\rockCompress$ = compressibilidade da rocha;
        \item $\porosidadeIni$ = porosidade na pressão de referência $\pressureIni$
    \end{description}
    
\end{frame}

\begin{frame}{Equação da pressão}
    Derivando \eqref{eq:modelo_mat.2} com relação ao tempo:

    \begin{equation}
        \label{eq:modelo_mat.2.1}
        \pd{\poroVolume}{\pressure} \pd{\pressure}{\timme} = \pd{\totalFluidVolume}{\pressure} \pd{\pressure}{\timme} + \sum_{\component}^{\numberOfComponents + 1} \left( \pd{\totalFluidVolume}{\molNumber_{\component}}  \right)_{\pressure} \pd{\molNumber_{\component}}{\timme}.
    \end{equation}

    Derivando o volume poroso em relação a pressão:

    \begin{equation}
        \label{eq:modelo_mat.5}
        \pd{\poroVolume}{\pressure} = \bulkVolume \porosidadeIni \rockCompress .
    \end{equation}
    
\end{frame}

\begin{frame}{Equação da pressão}
    Substituindo \eqref{eq:modelo_mat.5} em \eqref{eq:modelo_mat.2} temos:

    \begin{equation}
        \label{eq:modelo_mat.6}
        \bulkVolume \porosidadeIni \rockCompress \pd{\pressure}{\timme} = \pd{\totalFluidVolume}{\pressure} \pd{\pressure}{\timme} + \sum_{\component}^{\numberOfComponents + 1} \left( \pd{\totalFluidVolume}{\molNumber_{\component}}  \right)_{\pressure} \pd{\molNumber_{\component}}{\timme},
    \end{equation}

    Substituindo $\pd{\molNumber_{\component}}{\timme}$ de \eqref{eq:modelo_mat.6} em  \eqref{eq:modelo_mat.1} temos a equação da pressão:

    \begin{equation}
        \label{eq:modelo_mat.7}
        \left( \porosidadeIni \rockCompress - \dfrac{1}{\bulkVolume} \pd{\totalFluidVolume}{\pressure} \right) \pd{\pressure}{\timme} = \sum_{\component}^{\numberOfComponents + 1} \left( \pd{\totalFluidVolume}{\molNumber_{\component}}  \right)_{\pressure} \left[ \sum_{\phase}^{\numberOfPhases} \div{\left(\molarPartialFrac_{\component \phase} \molarDensityPhase \velocity_{\phase} \right)} + \dfrac{\mSourceTerm_{\component}}{\bulkVolume}\right], 
    \end{equation}
    
\end{frame}

\begin{frame}{Restrições}

    \begin{equation}
        \label{eq:modelo_mat.9}
        \sum_{\phase}^{\numberOfPhases} \Saturation_{\phase} = 1, \hspace{0.5cm} \sum_{\component}^{\numberOfComponents} \molarPartialFrac_{\component \oilPhase} = 1, \hspace{0.5cm} \sum_{\component}^{\numberOfComponents} \molarPartialFrac_{\component \gasPhase} = 1.
    \end{equation}

    A fim de garantir equilíbrio termodinâmico entre as fases:

    \begin{equation}
        \label{eq:modelo_mat.8}
        f_{\component o} = f_{\component g},
    \end{equation}
    
\end{frame}

% \begin{frame}{Equação do balanço molar}
    
% \end{frame}


\begin{frame}{Estratégia IMPEC}
    \centering
        \resizebox*{4cm}{!}{
        \input{./imgs/flowchart_impec.tex}}
\end{frame}


% \begin{frame}{Método \textit{Upwind}}
    
% \end{frame}

\subsection{Métodos de Transferência de escala}
\begin{frame}{Transferência de escala}
    \begin{figure}[!ht]
        \begin{subfigure}{0.4\textwidth}
            \centering
            \resizebox*{5cm}{!}{
            \input{./imgs/upscaling.tex}}
            \subcaption{\textit{Upscaling}}
            \label{fig:multiescala.1.b}
        \end{subfigure}
        \begin{subfigure}{0.55\textwidth}
            \centering
            \resizebox*{6.5cm}{!}{
            \input{./imgs/multiescala_classico.tex}}
            \subcaption{Multiescala}
            \label{fig:multiescala.1.a}
        \end{subfigure}
        % \label{fig:multiescala.1}
    \end{figure}
\end{frame}

\begin{frame}{Transferência de escala}
    \begin{figure}[!ht]
        \centering
        \resizebox*{7cm}{!}{
        \input{./imgs/multilevel_img.tex}}
        
        {\footnotesize Método ADM} 
        \label{fig:multinivel.1}
    \end{figure}
\end{frame}

\begin{frame}{Método Multiescala}
    \begin{figure}[!ht]
        % \caption{Malhas fina e grossa primal}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{5cm}{!}{
            \input{./imgs/im10.tex}}
            \subcaption{Volumes da malha fina}
            \label{fig:multiescala.2.a}
        \end{subfigure}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{5cm}{!}{
            \input{./imgs/im12.tex}}
            \subcaption{Volumes da malha grossa primal}
            \label{fig:multiescala.2.b}
        \end{subfigure}
        \label{fig:multiescala.2}
    \end{figure}
\end{frame}

\begin{frame}{Método Multiescala}
    \begin{figure}[!ht]
        % \caption{Malha grossa dual}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{5.9cm}{!}{
            \input{./imgs/im14.tex}}
            \subcaption{Classificação dos volumes}
            \label{fig:multiescala.3.a}
        \end{subfigure}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{4.25cm}{!}{
            \input{./imgs/im15.tex}}
            \subcaption{Volume da malha grossa dual $ \left( \volDual \right)$}
            \label{fig:multiescala.3.b}
        \end{subfigure}
        \label{fig:multiescala.3}
    \end{figure}
\end{frame}

\begin{frame}{Método Multiescala}
    
    \small 
    O Operador de Prolongamento ($\prolOperator$) é responsável por realizar o \textit{downscaling} das informações da malha grossa, e é encontrado a partir do cáculo das funções de base ($\basisFunctionIi$) dado por \cite{Zhou2012, Wang2014}:

    \begin{equation}
        \label{eq:multiescala.1}
        \begin{cases}
            \div{\left( \totalMobility \permTensor \grad{\basisFunctionIi} \right)} = 0 & \text{em } \volDual\\
            \vec{\nabla}_{\parallel} \cdot \left( \totalMobility \permTensor \grad{\basisFunctionIi} \right)_{\parallel} = 0 & \text{em } \boundaryVolDual\\
            \basisFunctionIi \left( x^{k}\right) = \kroneckerDelta_{Ik},
        \end{cases}
    \end{equation}

    onde $\boundaryVolDual$ é o contorno do volume dual $\volDual$, $\parallel$ indica a componente tangencial do fluxo em $\partial \volDual$, $x^{k}$ é o volume que é vértice da malha grossa dual e $\kroneckerDelta_{Ik}$ é o delta de Kronecker aplicado em $x^{k}$. Nesse trabalho foram adotadas as condições de contorno reduzidas \cite{Arthur_diss,Mazlumi_2021}.
\end{frame}

\begin{frame}{Método Multiescala}
    \begin{figure}[!ht]
        \caption{Valores das funções de base para o vértice $x_{1}$}
        \centering
        \includegraphics[scale=0.4]{./imgs/op_example.png}    
        \label{fig:operador_method.1}

        {\footnotesize Fonte: \cite{Hajibeygi_2020}}
    \end{figure}
\end{frame}

\begin{frame}{Método Multiescala}
    O operador de restrição utilizado nesse trabalho, que é responsável por realizar o \textit{Upscaling} das informações, é o operador clássico de volumes finitos, dado por \cite{Tene_2016}:

    \begin{equation}
        \label{eq:multiescala.11}
        \restOperator = 
        \begin{cases}
            1 & \text{ se } \volf \in \volcoarse\\
            0 & \text{ caso contrário }
        \end{cases}.
    \end{equation}
\end{frame}

\begin{frame}{Método Multiescala}
    \small
    \begin{gather*}
        \vectorPressure \approx \vectorMsPressure = \prolOperator \vectorCoarsePressure \\
        \fineTransmissibility \vectorPressure = \vectorfineSource  \longrightarrow \fineTransmissibility \prolOperator \vectorCoarsePressure = \vectorfineSource \\
        \restOperator \spaceum \fineTransmissibility \vectorPressure = \restOperator \vectorfineSource  \longrightarrow \coarseTransmissibility \vectorCoarsePressure = \coarseSourceTerm \\
        \coarseTransmissibility = \restOperator \spaceum \fineTransmissibility \prolOperator \\
        \coarseSourceTerm = \restOperator \vectorfineSource
    \end{gather*}

    \begin{description}[]
        \item $\vectorMsPressure$ = pressão multiescala;
        \item $\vectorCoarsePressure$ = pressão da escala grossa;
        \item $\coarseTransmissibility$ = matriz transmissibilidade da escala grossa;
        \item $\coarseSourceTerm$ = termo fonte da escala grossa;
        \item $\coarseTransmissibility \vectorCoarsePressure = \coarseSourceTerm$ : sistema linear da escala grossa
    \end{description}
\end{frame}

\begin{frame}{Método Multiescala}
    
    \small
    
    \begin{itemize}
        \item Devido a imposição de desacoplamento para construção do operador de prolongamento, a pressão multiescala não garante conservação da massa em todos os volumes da malha fina, fazendo-se necessária a reconstrução da velocidade \cite{Moyner_2014,Jenny2003}.
        \item Para esse fim, calcula-se o fluxo localmente, em cada volume da malha grossa primal, utilizando o fluxo do campo de pressão multiescala como condição de contorno.
    \end{itemize}
    

    

    % \begin{equation}
    %     \label{eq:5_5_4.1}
    %     \begin{cases}
    %       (K \lambda_{T} \grad{\mathbf{P}''}) \cdot \vec{n} = (K \lambda_{T} \grad{\vectorMsPressure}) \text{ em } \partial \Omega_{I}\\
    %       \div{K \lambda_{T} \grad{\mathbf{P}''}} = q \text{ em } \Omega_{I}\\
    %     \end{cases}
    %   \end{equation}

    %   \begin{columns}
    %     \begin{column}{0.5\textwidth}
    %         \begin{description}[]
    %             \item $\lambda_{T}$: mobilidade total do fluido = $\sum_{\phase} \lambda_{\phase}$ ;
    %             \item $\lambda$: mobilidade do fluido = $\nicefrac{k_{r}}{\mu}$;
    %             \item $k_r$: permeabilidade relativa 
    %           \end{description}
    %     \end{column}
    %     \begin{column}{0.5\textwidth}
    %         \begin{description}[]
    %             \item $\partial \Omega_{I}$: Contorno do volume $\Omega_{I}$ 
    %           \end{description}
    %     \end{column}

    %   \end{columns}
\end{frame}

% \begin{frame}{Método Multiescala}
    
% \end{frame}


\begin{frame}{Método ADM}
    \small
    A transferência de escala para o nível superior ($l$) é feita utilizando os operadores ADM da seguinte forma \cite{Cusini2016}:

    \begin{equation}
        \label{eq:multinivel.1}
    (\prolOperatorAdm)^{l}_{l-1} (i,j) =
        \begin{cases}
            (\prolOperator)^{l}_{l-1} (i,j) \text{ se a célula } i \in \Gamma^{l-1} \text{ e a célula } j \in \hat{\Pi}^{l}\\
            \delta_{ij} \text{ caso contrário},\\
        \end{cases}
    \end{equation}

    \begin{equation}
        \label{eq:multinivel.2}
    (\restOperatorAdm)^{l-1}_{l} (i,j) =
        \begin{cases}
            (\restOperator)^{l-1}_{l} (i,j) \text{ se a célula } i \in \Gamma^{l} \text{ e a célula } j \in \Gamma^{l-1}\\
            \delta_{ij} \text{ caso contrário}.\\
        \end{cases}
    \end{equation}

\end{frame}

\begin{frame}{Método ADM}
    \begin{figure}
        \caption{Representação dos conjuntos $\Omega^{l}$, $\Pi^{l}$ e $\Gamma^{l}$}
        \begin{subfigure}{.3\textwidth}
            \centering
            \resizebox*{3cm}{!}{
            \input{./imgs/adm2.tex}}
            \subcaption{$\Omega^{l}$}
            \label{fig:multinivel.2.a}
        \end{subfigure}
        \begin{subfigure}{.3\textwidth}
            \centering
            \resizebox*{3cm}{!}{
            \input{./imgs/adm1.tex}}
            \subcaption{$\Pi^{l}$}
            \label{fig:multinivel.2.b}
        \end{subfigure}
        \begin{subfigure}{.3\textwidth}
            \centering
            \resizebox*{3cm}{!}{
            \input{./imgs/adm3.tex}}
            \subcaption{$\Gamma^{l}$}
            \label{fig:multinivel.2.c}
        \end{subfigure}
        \label{fig:multinivel.2}
    \end{figure}

    \begin{equation}
        \label{eq:multinivel.3}
        ( \restOperatorAdm )^{l-1}_{l} ... ( \restOperatorAdm )^{0}_{1} \fineTransmissibility (\prolOperatorAdm)^{l}_{l-1} ... (\prolOperatorAdm)^{1}_{0} \vectorPressureAdm = ( \restOperatorAdm )^{l-1}_{l} ... ( \restOperatorAdm )^{0}_{1} \vectorfineSource,
    \end{equation}
\end{frame}

\begin{frame}{Método NU-ADM}
    A fim de diminuir a quantidade de volumes na malha ADM, foi desenvolvido por \citeonline{Araujo_dos_Santos_2022} o método ADM não uniforme (NU-ADM), permitindo que os volumes não engrossados não estejam necessariamente agrupados de acordo com o volume da malha grossa, reduzindo o sistema linear da escala ADM.


\end{frame}

\begin{frame}{Método NU-ADM}
    \begin{figure}
        \caption{Diferença entre os métodos ADM e NU-ADM}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{5cm}{!}{
            \input{./imgs/adm2.tex}}
            \subcaption{Método ADM}
            \label{fig:multinivel.3.a}
        \end{subfigure}
        \begin{subfigure}{.48\textwidth}
            \centering
            \resizebox*{5cm}{!}{
            \input{./imgs/adm4.tex}}
            \subcaption{Método NU-ADM}
            \label{fig:multinivel.3.b}
        \end{subfigure}
        \label{fig:multinivel.2}
    \end{figure}

\end{frame}

\section{Metodologia}
\begin{frame}{Seleção dos níveis}
    \small
    \begin{itemize}
        \item Os volumes da malha grossa que possuírem algum volume com valores prescritos de vazão ou pressão, serão mantidos inteiramente no menor nível, ou seja, na malha fina, a fim de capturar melhor os gradientes de pressão nessa região.
        \item Será definido um valor limite ($\Delta \Saturation_{lim}$) pelo usuário para o qual será calculada a variação de saturação das fases ($\Delta \Saturation$) entre os volumes da malha fina adjacentes por face. Caso essa variação de saturação ultrapasse o valor definido pelo usuário, ambos volumes serão mantidos na malha fina.
        \item Em alguns passos de tempo pode acontecer de algum volume da malha fina apresentar o número de mols negativo, com valor próximo de zero. Nessa situação, esse volume e seus vizinhos são mantidos na malha fina para o próximo passo de tempo e o número de mols é mantido como zero, sendo atualizado no próximo passo de tempo.
    \end{itemize}
\end{frame}

\begin{frame}{Operador de Prolongamento}
    \small
    \begin{itemize}
        \item O operador de prolongamento foi construído segundo o método AMS (\textit{Algebraic Multiscale Solver}) \cite{Wang2015,Moyner_2014}
    \end{itemize}

    \begin{figure}[!ht]
        
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[scale=0.27]{./imgs/im10.png}
            \subcaption{$\fineTransmissibility$}
            \label{fig:multiescala.4.a}
        \end{subfigure}
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[scale=0.27]{./imgs/im11.png}
            \subcaption{\finewirebasketMatrix}
            \label{fig:multiescala.4.b}
        \end{subfigure}
        \begin{subfigure}{.3\textwidth}
            \centering
            \includegraphics[scale=0.27]{./imgs/im12.png}
            \subcaption{$\finewirebasketMatrixMod$}
            \label{fig:multiescala.4.c}
        \end{subfigure}
        
        {\footnotesize Fonte:\cite{Magri2015}}
        \label{fig:multiescala.4}
    \end{figure}

\end{frame}

\begin{frame}{Atualização das funções de base}
    As funções de base são atualizadas segundo \citeonline{Zhou2010}, utilizando um valor determinado pelo usuário ($\epsilon$) para verificar a variação da mobilidade de cada fase entre dois passos de tempo consecutivos ($n-1$ e $n$), conforme a seguinte equação:

\begin{equation}
    \dfrac{1}{1+\epsilon} < \dfrac{\mobility_{\phase}^{n}}{\mobility_{\phase}^{n-1}}  < 1 + \epsilon  
    \label{eq:update_bf.1}
\end{equation}
\end{frame}

\begin{frame}{Método de solução da pressão e composições}

    \begin{itemize}
        \item O cálculo da pressão é realizada de acordo com \citeonline{Zhou2012}, utilizando o \textit{solver} de Richardson;
        \item No \textit{solver} de Richardson, nas iterações intermediárias, o operador de restrição é o transposto do operador de prolongamento.
        \item A solução explícita do transporte é resolvida na malha fina, e, como é de suma importância que o campo de pressão seja conservativo, na última iteração utiliza-se o operador de restrição de volumes finitos. 
    \end{itemize}
    
\end{frame}

\newcounter{problem}
\renewcommand*{\theproblem}{%
    \arabic{problem}%
}

\section{Resultados}

\refstepcounter{problem}
\subsection{Problema \theproblem}
\begin{frame}{Problema \theproblem: Escoamento bidimensional bifásico}

    \begin{itemize}
        \item A malha possui 80x80 volumes
        \item pressão (P) prescrita no último volume de $13,79MPa$
        \item vazão (Q) prescrita de injeção de água de $ 3,277 \times 10^{-8} \nicefrac{m^{3}}{s}$ no primeiro volume. 
        \item O campo de permeabilidade é homogêneo e igual em todas as três direções cartesianas no valor de $4,9346 10^{-13} m^{2}$.
        \item Foram aplicadas as razões de engrossamento de 7 e 5.
    \end{itemize}

    
\end{frame}

\begin{frame}{Problema \theproblem}
    \fboxrule=0pt
\renewcommand{\arraystretch}{1.2}
\setlength{\tabcolsep}{5pt}
\setlength{\extrarowheight}{2pt}
\begin{table}[!ht]
    \small
    \centering
    \begin{subtable}[t]{0.48\textwidth}
        \centering
        \begin{tabular}{|c|c|}
            \hline
            $\Saturation_{\oilPhase r \waterPhase}$ & $0,35$ \\
            \hline
            $\Saturation_{\waterPhase r}$ & $0,2$ \\
            \hline
            $k_{r \waterPhase}^{0}$ & $0,2$ \\
            \hline
            $k_{r \oilPhase \waterPhase}^{0}$ & $1$ \\
            \hline
            $e_{\waterPhase}$ & $2$ \\
            \hline
            $e_{\oilPhase \waterPhase}$ & $2$ \\
            \hline
        \end{tabular}
        \caption{Permeabilidade relativa}
    \end{subtable}
    \hspace{\fill}
    \begin{subtable}{0.48\textwidth}
        \centering
        \begin{tabular}{|c|c|}
            \hline
            Pressão inicial & $13,79MPa$ \\
            \hline
            $\Saturation_{\waterPhase}^{0}$ & $0,2$ \\
            \hline
            $\porosidade$ & 0,2 \\
            \hline
            $\temperature$ & $288,7 K$ \\
            \hline
        \end{tabular}
        \caption{Condições Iniciais}
        \label{tab:table_prob4.b}
    \end{subtable}
\end{table}
% \begin{table}[!ht]
%     \centering
%     \caption{Dados do Problema \theproblem}
%     \begin{subtable}[t]{0.48\textwidth}
%         \centering
%         \begin{tabular}{|c|c|}
%             \hline
%             $\Saturation_{\oilPhase r \waterPhase}$ & $0,35$ \\
%             \hline
%             $\Saturation_{\waterPhase r}$ & $0,2$ \\
%             \hline
%             $k_{r \waterPhase}^{0}$ & $0,2$ \\
%             \hline
%             $k_{r \oilPhase \waterPhase}^{0}$ & $1$ \\
%             \hline
%             $e_{\waterPhase}$ & $2$ \\
%             \hline
%             $e_{\oilPhase \waterPhase}$ & $2$ \\
%             \hline
%         \end{tabular}
%         \caption{Permeabilidade relativa}
%         \label{tab:table_prob4.a}
%     \end{subtable}
%     \hspace{\fill}
%     \begin{subtable}{0.48\textwidth}
%         \centering
%         \begin{tabular}{|c|c|}
%             \hline
%             Pressão inicial & $13,79MPa$ \\
%             \hline
%             $\Saturation_{\waterPhase}^{0}$ & $0,2$ \\
%             \hline
%             $\porosidade$ & 0,2 \\
%             \hline
%             $\temperature$ & $288,7 K$ \\
%             \hline
%         \end{tabular}
%         \caption{Condições Iniciais}
%         \label{tab:table_prob4.b}
%     \end{subtable}
%     \bigskip
%     \centering
%     \begin{subtable}{\textwidth}
%         \centering
%         \begin{tabular}{|c|c|c|c|}
%             \hline
%             Massa molar $[\nicefrac{g}{mol}]$ & $142,276$ \\
%             \hline
%             $\criticalT [K]$ & $619,27 $\\
%             \hline
%             $\criticalP[MPa]$ & $2,109$\\
%             \hline
%             Acentricidade & $0,489$\\
%             \hline
%             $\criticalV [\nicefrac{m^{3}}{mol} \times 10^{-4}]$ & $6,03$\\
%             \hline            
%         \end{tabular}
%         \caption{Dados do componente hidrocarboneto}
%         \label{tab:table_prob4.c}
%     \end{subtable}
%     \legend{Elaborado pelo autor}
%     \label{tab:table_prob4}
% \end{table}
\end{frame}
% \setcounter{table}{2}
\begin{frame}{Problema \theproblem}
    \small
    \begin{table}[!ht]
        \centering
        \begin{subtable}{\textwidth}
            \centering
            \begin{tabular}{|c|c|c|c|}
                \hline
                Massa molar $[\nicefrac{g}{mol}]$ & $142,276$ \\
                \hline
                $\criticalT [K]$ & $619,27 $\\
                \hline
                $\criticalP[MPa]$ & $2,109$\\
                \hline
                Acentricidade & $0,489$\\
                \hline
                $\criticalV [\nicefrac{m^{3}}{mol} \times 10^{-4}]$ & $6,03$\\
                \hline            
            \end{tabular}
            \caption{Dados do componente hidrocarboneto}
            \label{tab:table_prob4.c}
        \end{subtable}
    \end{table}
\end{frame}

\newcommand{\FrameProblemName}{Problema \theproblem}
\begin{frame}{\FrameProblemName}
    \begin{figure}
        \centering
        \caption{Localização das prescrições}
        \includegraphics[scale=0.25]{./imgs/prescricao.png}
        \label{fig:fig3_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}
        \caption{Malha dual}
        \centering
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.25]{imgs/dual_pr4_cr7.png}
            \caption{Malha dual para Cr = 7}
        \end{subfigure}
        \hspace{\fill}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.25]{imgs/dual_pr4_cr5.png}
            \caption{Malha dual para Cr = 5}
        \end{subfigure}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Tempos de simulação}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/tempo_sim_cr7.png}
            \caption{Tempo de simulação Cr=7.}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/total_time_cr7.png}
            \caption{Tempo total de simulação Cr=7.}
        \end{subfigure}
        % \bigskip
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.55]{./imgs/pr4/tempo_sim_cr5.png}
        %     \caption{Tempo de simulação Cr=5.}
        % \end{subfigure}
        % \hfill
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.57]{./imgs/pr4/total_time_cr5.png}
        %     \caption{Tempo total de simulação Cr=5.}
        % \end{subfigure}
        \label{fig:fig4_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Tempos de simulação}
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.4]{./imgs/pr4/tempo_sim_cr7.png}
        %     \caption{Tempo de simulação Cr=7.}
        % \end{subfigure}
        % \hfill
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.4]{./imgs/pr4/total_time_cr7.png}
        %     \caption{Tempo total de simulação Cr=7.}
        % \end{subfigure}
        % \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/tempo_sim_cr5.png}
            \caption{Tempo de simulação Cr=5.}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/total_time_cr5.png}
            \caption{Tempo total de simulação Cr=5.}
        \end{subfigure}
        \label{fig:fig4.2_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Curvas de produção.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/oil_prod_cr7.png}
            \caption{Cr=7.}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/oil_prod_cr5.png}
            \caption{Cr=5.}
        \end{subfigure}
        \label{fig:fig5_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Volumes Ativos.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/active_vols_cr7.png}
            \caption{Cr=7.}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[scale=0.4]{./imgs/pr4/active_vols_cr5.png}
            \caption{Cr=5.}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig6_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Malha NU-ADM}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=4.6cm]{./imgs/pr4/sat_cr7.png}
            \caption{Saturação de água Cr=7. Vermelho = 0,65, Azul = 0,2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=4.7cm]{./imgs/pr4/nivel_cr7.png}
            \caption{Nível Cr=7. Azul=0, Vermelho=1}
        \end{subfigure}
        % \bigskip
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.4]{./imgs/pr4/sat_cr5.png}
        %     \caption{Saturação de água Cr=5. Vermelho = 0,65, Azul = 0,2}
        % \end{subfigure}
        % \hfill
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[scale=0.41]{./imgs/pr4/nivel_cr5.png}
        %     \caption{Nível Cr=5. Azul=0, Vermelho=1}
        % \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig7_pr4}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{figure}[!htbp]
        \centering
        \caption{Malha NU-ADM}
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[height=4.6cm]{./imgs/pr4/sat_cr7.png}
        %     \caption{Saturação de água Cr=7. Vermelho = 0,65, Azul = 0,2}
        % \end{subfigure}
        % \hfill
        % \begin{subfigure}{.48\textwidth}
        %     \centering
        %     \includegraphics[height=4.7cm]{./imgs/pr4/nivel_cr7.png}
        %     \caption{Nível Cr=7. Azul=0, Vermelho=1}
        % \end{subfigure}
        % \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=4.6cm]{./imgs/pr4/sat_cr5.png}
            \caption{Saturação de água Cr=5. Vermelho = 0,65, Azul = 0,2}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=4.7cm]{./imgs/pr4/nivel_cr5.png}
            \caption{Nível Cr=5. Azul=0, Vermelho=1}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig7_pr4}
    \end{figure}
\end{frame}

\refstepcounter{problem}
\subsection{Problema \theproblem}

\begin{frame}{\FrameProblemName}

    \begin{itemize}
        \item Escoamento trifásico, 1D e com 6 componentes hidrocarbonetos. 
        \item A malha possui 512 volumes 
        \item Vazão prescrita de injeção de água no primeiro volume de $4.1377 \times 10^{-4} \nicefrac{m^{3}}{s}$. 
        \item No último volume da malha há pressão prescrita de $8, 96MPa$. 
        \item O coeficiente de interação binária entre os componentes é zero.
        \item  Campo de permeabilidade homogêneo e igual em todas as três direções cartesianas no valor de $10^{-14} m^{2}$.
    \end{itemize}
    
\end{frame}

\begin{frame}{\FrameProblemName}
    \fboxrule=0pt
\renewcommand{\arraystretch}{1.2}
\setlength{\tabcolsep}{5pt}
\setlength{\extrarowheight}{2pt}
\begin{table}[!ht]
    \footnotesize
    \centering
    % \caption{Dados do Problema \theproblem}
    \begin{subtable}[t]{0.48\textwidth}
        \centering
        \begin{tabular}{|c|c|c|c|}
            \hline
            $\Saturation_{\oilPhase r \gasPhase}$ & $0$ & $k_{r \oilPhase \waterPhase}^{0}$ & $0,9$ \\
            \hline
            $\Saturation_{\oilPhase r \waterPhase}$ & $0,1$ & $k_{r \oilPhase \gasPhase}^{0}$ & $0,9$ \\
            \hline
            $\Saturation_{\gasPhase r}$ & 0 & $e_{\waterPhase}$ & $2$ \\
            \hline
            $\Saturation_{\waterPhase r}$ & $0,3$ & $e_{\oilPhase \gasPhase}$ & $2$\\
            \hline
            $k_{r \gasPhase}^{0}$ & $0,9$ & $e_{\oilPhase \waterPhase}$ & $2$\\
            \hline
            $k_{r \waterPhase}^{0}$ & $0,4$ & $e_{\gasPhase}$ & $2$\\
            \hline
        \end{tabular}
        \caption{Permeabilidade relativa}
        \label{tab:table_prob3.a}
    \end{subtable}
    % \hspace{\fill}
    \begin{subtable}{0.48\textwidth}
        \centering
        \begin{tabular}{|c|c|}
            \hline
            Pressão inicial & $10,34MPa$ \\
            \hline
            $\Saturation_{\waterPhase}^{0}$ & 0,3 \\
            \hline
            $\porosidade$ & 0,35 \\
            \hline
            $\temperature$ & $344,25 K$ \\
            \hline
            \rowcolor{gray!40}
            \multicolumn{2}{|Sc|}{ Composição inicial} \\
            \hline
            C1 & $0,5$ \\
            \hline         
            C2 & $0,03$ \\
            \hline         
            C3 & $0,07$ \\       
            \hline  
            C4 & $0,2$ \\       
            \hline  
            C5 & $0,15$ \\       
            \hline  
            C6 & $0,05$ \\       
            \hline  
        \end{tabular}
        \caption{Condições Iniciais}
        \label{tab:table_prob3.b}
    \end{subtable}
    \end{table}
\end{frame}

\begin{frame}{\FrameProblemName}
    \begin{table}
        \small
        \centering
        \begin{subtable}{\textwidth}
            \centering
            \begin{tabular}{|c|c|c|c|c|c|c|}
                \hline
                 & C1 & C2 & C3 & C4 & C5 & C6 \\
                \hline
                Massa molar $[\nicefrac{g}{mol}]$ & $16,042 $ & $44,1$ & $86,178$ & $142,276$ & $212,41$ & $282,5$\\
                \hline
                $\criticalT$ $[K]$ & $190,6 $ & $369,8$ & $507,4$ & $617,6$ & $708$ & $768$\\
                \hline
                $\criticalP$ $[MPa]$ & $4,6$ & $4,24$ & $2,96$ & $2,11$ & $1,47$ & $1,17$\\
                \hline
                Acentricidade & $0,008$ & $0,152$ & $0,299$ & $0,489$ & $0,685$ & $0,912$\\
                \hline
                $\criticalV$ $[\nicefrac{m^{3}}{mol} \times 10^{-4}]$ & $0,99 $ & $2.03$ & $3,7$ & $6,03$ & $8,95$ & $16,9$\\
                \hline            
            \end{tabular}
            \caption{Dados dos componentes}
            \label{tab:table_prob3.c}
        \end{subtable}
    \end{table}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=64 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/no_update/svgtopng/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/no_update/svgtopng/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/no_update/svgtopng/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        % \label{fig:fig1_pr3-cr64}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=64 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=64 atualizando as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/volumes_update.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig2_pr3-cr64}
        
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=64.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=64.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/no_update/svgtopng/tempo_simulacao.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/no_update/svgtopng/tempo_total.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/tempo_simulacao.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr64/update/svgtopng/tempo_total.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig3_pr3-cr64}
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=16 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=16 sem atualizar as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/no_update/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/no_update/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/no_update/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig4_pr3-cr16}
        
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=16 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=16 atualizando as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/volumes_update.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig5_pr3-cr16}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=16.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=16.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/no_update/tempo_simulacao.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/no_update/tempo_total.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/tempo_simulacao.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/tempo_total.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig6_pr3-cr16}
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=100 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=100 sem atualizar as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/no_update/svgtopng/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/no_update/svgtopng/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/no_update/svgtopng/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig7_pr3-cr100}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=100 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=100 atualizando as funções de base.}
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/update/svgtopng/gas_prod.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/update/svgtopng/oil_prod.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/update/svgtopng/volumes_ativos.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/update/svgtopng/n_volumes_update.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig8_pr3-cr100}
        
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=100.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=100.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/no_update/svgtopng/tempo_de_simulacao.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr100/no_update/svgtopng/tempo_total.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/tempo_simulacao.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr3/cr16/Update/tempo_total.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig9_pr3-cr100}
    \end{figure}
\end{frame}

\refstepcounter{problem}
\subsection{Problema \theproblem}

\begin{frame}{\FrameProblemName}
    \begin{itemize}
        \item Escoamento 1D com 3 componentes hidrocarbonetos e com duas fases (óleo e gás). 
        \item A malha possui 5000 volumes 
        \item Pressão prescrita no primeiro volume de $7MPa$ e composição prescrita de injeção de $0,9$ do componente C1 e $0,1$ do componente C2. 
        \item No último volume da malha há pressão prescrita de $6MPa$. 
        \item O coeficiente de interação binária entre os componentes é zero 
        \item A dimensão dos volumes na direção x é de $0,01m$. 
        \item Campo de permeabilidade homogêneo no valor de $10^{-15} m^{2}$.
        \item Foram utilizadas as razões de engrossamento de 20, 50 e 100.
    \end{itemize}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=20 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=20 sem atualizar as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR20_no__updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR20_no__updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR20_no__updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig1_pr2-cr20}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=20 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=20 atualizando as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm   ]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateTotal volumes.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig2_pr2-cr20}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=20.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=20.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR20_no__updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR20_no__updateTotal_simulation_time.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 20/v2/update/svgtopng/figura_case-finescale_3k_5000_CR20_updateTotal_simulation_time.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig3_pr3-cr20}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=50 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=50 sem atualizar as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR50_no_updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR50_no_updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR50_no_updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig4_pr2-cr50}
        
    \end{figure}
    
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=50 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=50 atualizando as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateTotal volumes.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig5_pr2-cr50}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=50.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=50.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR50_no_updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/no_update/svgtopng/figura_case-finescale_3k_5000_CR50_no_updateTotal_simulation_time.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 50/v2/update/svgtopng/figura_case-finescale_3k_5000_CR50_updateTotal_simulation_time.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig6_pr2-cr50}
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=100 sem atualizar as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=100 sem atualizar as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_no_update/svgtopng/figura_case-finescale_3k_5000_CR100_no_updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_no_update/svgtopng/figura_case-finescale_3k_5000_CR100_no_updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_no_update/svgtopng/figura_case-finescale_3k_5000_CR100_no_updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig7_pr2-cr100}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Resultados com Cr=100 atualizando as funções de base.}}
    \begin{figure}[!ht]
        \centering
        % \caption{Resultados com Cr=100 atualizando as funções de base.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateGas_production.png}
            \caption{Produção de gás}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateOil_production.png}
            \caption{Produção de óleo}
        \end{subfigure}
        \bigskip
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateActive_volumes.png}
            \caption{Volumes ativos}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateTotal volumes.png}
            \caption{Quantidade de volumes para atualizar as funções de base}
        \end{subfigure}
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig8_pr2-cr100}
        
    \end{figure}
\end{frame}

\begin{frame}{\FrameProblemName: {\small Tempos de simulação com Cr=100.}}
    \begin{figure}[!h]
        \centering
        % \caption{Tempos de simulação com Cr=100.}
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_no_update/svgtopng/figura_case-finescale_3k_5000_CR100_no_updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação sem atualizar as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_no_update/svgtopng/figura_case-finescale_3k_5000_CR100_no_updateTotal_simulation_time.png}
            \caption{Tempo total de simulação sem atualizar as funções de base}
        \end{subfigure}
        \bigskip
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateTempo de simulaçãoActive_volumes.png}
            \caption{Tempo de simulação atualizando as funções de base}
        \end{subfigure}
        \hfill
        \begin{subfigure}[t]{.48\textwidth}
            \centering
            \includegraphics[height=2.5cm]{./imgs/pr2/3k_5000x1x1/cr 100/3k_5000_cr100_update/svgtopng/figura_case-finescale_3k_5000_CR100_updateTotal_simulation_time.png}
            \caption{Tempo total de simulação atualizando as funções de base}
        \end{subfigure}
    
        % \legend{Fonte: Elaborado pelo autor.}
        \label{fig:fig9_pr2-cr100}
    \end{figure}
\end{frame}



\section{Conclusões}
\begin{frame}{Conclusões}

    \begin{itemize}
        \item Desenvolvimento do simulador NU-ADM composicional.
        \item Foram simulados 3 exemplos: um 2D e dois 1D (Problema 2 com 6 componentes e o Problema 3 com 3).
        \item No Problema 1 foi possível verificar a adaptação da malha.
        \item No Problema 2, noutou-se melhor performance com uma razão de engrossamento intermediária, mesmo atualizando as funções de base.
        \item No Problema 3 todas as soluções NU-ADM se aproximaram da malha fina, mas atualizar as funções de base não melhorou significativamente os resultados.
    \end{itemize}

%     Para a verificar a acurácia do método NU-ADM e os tempos de simulação, foram utilizados um exemplo bidimensional bifásico e dois unidimensionais trifásicos, todos sendo simulados em modo serial. No primeiro exemplo, com apenas um componente na fase óleo, foi possível observar como se comporta o refinamento da malha NU-ADM na frente de saturação de acordo com $\Delta \Saturation_{lim}$ e que a solução NU-ADM se aproxima da solução obtida diretamente na malha fina. 

% Nos outros dois exemplos (um com 6 componentes hidrocarbonetos e o outro com três) foram verificados a acurácia do método NU-ADM e os tempos de simulação com diferentes razões de engrossamento. No primeiro notou-se uma melhor \textit{performance} com a razão de engrossamento intermediária (64), onde o fato de atualizar as funções de base melhorou a solução, aproximando mais da solução da malha fina, enquanto que, não atualizar as funções de base resultou numa solução com menor acurácia porém com um tempo de simulação menor que o da escala fina. No terceiro exemplo, em todas razões de engrossamento, a solução NU-ADM foi igual a da malha fina, onde o fato de atualizar as funções de base não influenciou significativamente na acurácia, mas apenas no tempo de simulação.
    
\end{frame}

\begin{frame}{Conclusões}
    São apontadas como sugestões para trabalhos futuros:

\begin{itemize}
    \item Incluir os efeitos da gravidade e da capilaridade;
    \item Adicionar outros níveis de engrossamento;
    \item Implementar o método NU-ADM em outras estratégias de solução (como os métodos sequencial implícito o totalmente implícito);
    \item Implementar o método NU-ADM em malhas não estruturadas.
\end{itemize}
    
\end{frame}


\section{Referências}

\begin{frame}[allowframebreaks]{Referências}
    \scriptsize
    \bibliography{fonts.bib}
\end{frame}

\begin{frame}
    \centering
    \LARGE
    Obrigado!!!
\end{frame}


\end{document}
